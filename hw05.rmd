---
title: "Homework 05"
author: "Anika Cartas"
date: "Wednesday, April 08, 2015"
output: word_document
---

###0. Read Data

The table lists measurements of DC output at different wind velocity.

* Dependent variable: DC
* Independent variable: Wind Velocity

```{r}
data <- data.frame(
  vel = c(5,6,3.4,2.7,10,9.7,9.55,3.05,8.15,6.2,2.9,6.35,4.6,5.8,7.4,3.6,7.85,8.8,7,5.45,9.1,10.2,4.1,3.95,2.45),
  dc = c(1.582,1.822,1.057,0.5,2.236,2.386,2.294,0.558,2.166,1.866,0.653,1.93,1.562,1.737,2.088,1.137,2.179,2.112,1.8,1.501,2.303,2.310,1.194,1.144,0.123))

data <- data[with(data,order(vel)),]

attach(data)
```

###1. Linear Regression

```{r}
reg.linear <- lm(dc~vel)

plot(dc~vel, main="Linear Regression")
abline(reg.linear, col="red")
```

###2. Polynomial Regression

```{r}
plot(dc~vel, main="Polynomial Regression")
lines(lowess(dc~vel), col="green")
```

Using lowess, we visualize this to be a 4th degree polynomial. However, let's see if we can get more details.

```{r}
fit2 <- lm(dc ~ poly(vel, 2, raw=TRUE))
fit3 <- lm(dc ~ poly(vel, 3, raw=TRUE))
fit4 <- lm(dc ~ poly(vel, 4, raw=TRUE))
fit5 <- lm(dc ~ poly(vel, 5, raw=TRUE))
summary(fit2)
summary(fit3)
summary(fit4)
summary(fit5)
```

Depending on how specific we want to get, it looks like we are adding significant variables up to 4th degree, though maybe just 2nd or 3rd is fine. I'm not sure how to decide what the cut-off point is, but based on recommendations am going to continue with 2nd degree polynomial.

```{r}
plot(dc~vel, main="Polynomial Regression")
lines(lowess(dc~vel), col="green")
reg.poly <- lm(dc ~ poly(vel, 2, raw=TRUE))
lines(vel, predict(reg.poly),col="darkgreen") 

legend("bottomright", c("Estimate","Modelled"), col=c("green","darkgreen"), lwd=2)
```

###3. Transformation Based Regression

The Box-Cox Power Transformation identifies an appropriate exponent (lambda) to transform the data into a normal shape. The Lambda value indicates the power to which all data should be raised. 

When lambda is plotted against log likelihood, the best lambda is the one that maximizes the log likelihood.

Changed this to be vel ~ dc following advice from article sent out by Danielle, but I'm not sure why it works this way. Originally I had it as dc ~ vel, which led to lambda = 2.

```{r}
library(MASS)
bc <-boxcox(vel ~ dc)

(maxll <- max(bc$y))
(lambda <- bc$x[which(bc$y == maxll)])
```

Maximum log likelihood of 27.17 is achieved when lamda is equal to -0.75.

```{r}
reg.trans<-lm(dc ~ I(vel^lambda))
plot(dc ~ I(vel^lambda), main="Transformation Based Regression")
abline(reg.trans, col="blue")
```

###4. Nonlinear Regression

I will attempt to solve using least squares approach, following directions from Simran's tutorial.
As of class time, I am unsure of how to determine the model I should be using.

```{r}
```

###5. Discussion

Discuss which models are best for this dataset and the physical processes described by your models.

```{r}
```
